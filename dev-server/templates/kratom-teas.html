<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kratom Teas | WTF Welcome To Florida</title>
    <meta name="description" content="Build your perfect kratom tea with our advanced drink builder. Choose size, strain, and flavors from our premium selection.">
    <link rel="stylesheet" href="/assets/base.css">
    <style>
        :root {
            --color-primary: #ff6600;
            --color-secondary: #ffffff;
            --color-accent: #333333;
            --color-success: #28a745;
            --color-warning: #ffc107;
            --color-danger: #dc3545;
        }

        body {
            background: linear-gradient(180deg, rgba(255, 102, 0, 0.02) 0%, rgba(255, 255, 255, 1) 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        .page-header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 1rem 0;
        }

        .page-header .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .back-link {
            color: var(--color-primary);
            text-decoration: none;
            font-size: 0.9rem;
        }

        .page-title {
            font-size: 2rem;
            color: var(--color-accent);
            margin: 0;
        }

        /* Enhanced Drink Builder */
        #enhanced-drink-builder {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        #enhanced-drink-builder h2 {
            font-size: 1.875rem;
            font-weight: 700;
            margin: 0 0 1.5rem 0;
            color: var(--color-accent);
            text-align: center;
        }

        .product-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
            display: block;
        }

        fieldset {
            border: none;
            padding: 0;
            margin: 0 0 1.5rem 0;
        }

        legend {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            padding: 0;
            display: block;
            width: 100%;
            color: var(--color-accent);
        }

        .price-row {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f3f4f6;
        }

        .current-price {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--color-primary);
        }

        .chip-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .chip {
            display: inline-flex;
            align-items: center;
            background-color: #f9f9f9;
            border: 2px solid #e5e7eb;
            border-radius: 50px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .chip:hover {
            border-color: var(--color-primary);
            background-color: rgba(255, 102, 0, 0.05);
        }

        .chip.active {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .chip input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            margin: 0;
            cursor: pointer;
        }

        /* Flavor Selection */
        .flavor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .flavor-item {
            background: #f9f9f9;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            transition: all 0.2s ease;
        }

        .flavor-item.active {
            border-color: var(--color-primary);
            background-color: rgba(255, 102, 0, 0.05);
        }

        .flavor-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--color-accent);
        }

        .pump-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .pump-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #ccc;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
        }

        .pump-btn:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .pump-count {
            min-width: 20px;
            text-align: center;
            font-weight: bold;
        }

        /* Strain Selection */
        .strain-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .strain-chip {
            padding: 0.75rem;
            text-align: center;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .strain-chip:hover {
            border-color: var(--color-primary);
        }

        .strain-chip.active {
            border-color: var(--color-primary);
            background: var(--color-primary);
            color: white;
        }

        /* Mix Options */
        .mix-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .mix-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* Notes Section */
        .notes-section textarea {
            width: 100%;
            min-height: 80px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 0.75rem;
            font-family: inherit;
            resize: vertical;
        }

        .notes-section textarea:focus {
            border-color: var(--color-primary);
            outline: none;
        }

        /* Add to Cart Button */
        .add-to-cart-btn {
            width: 100%;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 1rem;
        }

        .add-to-cart-btn:hover {
            background: #e55a00;
            transform: translateY(-2px);
        }

        .add-to-cart-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Notices */
        .notice {
            background-color: #fefce8;
            color: #854d0e;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .error-notice {
            background-color: #fef2f2;
            color: #dc2626;
        }

        .success-notice {
            background-color: #f0fdf4;
            color: #16a34a;
        }

        /* Responsive */
        @media (max-width: 768px) {
            #enhanced-drink-builder {
                margin: 1rem;
                padding: 1.5rem;
            }

            .flavor-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <a href="/" class="back-link">‚Üê Back to Menu</a>
            <h1 class="page-title">Kratom Teas</h1>
        </div>
    </header>

    <!-- Enhanced Drink Builder -->
    <main id="enhanced-drink-builder">
        <h2>üçµ Build Your Kratom Tea</h2>
        <img src="/assets/kratom_teas_150x150.jpg" alt="Kratom Tea" class="product-image" onerror="this.style.display='none'">
        
        <form id="drink-builder-form">
            <!-- Price Display -->
            <div class="price-row">
                <span class="current-price" id="current-price">$9.00</span>
                <div style="text-align: right; font-size: 0.875rem; color: #666;">
                    <div>Premium kratom blend</div>
                    <div>Handcrafted daily</div>
                </div>
            </div>

            <!-- Size Selection -->
            <fieldset>
                <legend>Choose Size</legend>
                <div class="chip-row">
                    <label class="chip active" data-size="medium" data-price="9.00">
                        <input type="radio" name="size" value="medium" checked>
                        Medium (16oz)
                    </label>
                    <label class="chip" data-size="large" data-price="15.00">
                        <input type="radio" name="size" value="large">
                        Large (24oz)
                    </label>
                    <label class="chip" data-size="gallon" data-price="100.00">
                        <input type="radio" name="size" value="gallon">
                        Gallon (128oz)
                    </label>
                </div>
            </fieldset>

            <!-- Strain Selection -->
            <fieldset>
                <legend>Select Strain</legend>
                <div class="strain-options">
                    <div class="strain-chip active" data-strain="green">Green</div>
                    <div class="strain-chip" data-strain="red">Red</div>
                    <div class="strain-chip" data-strain="white">White</div>
                    <div class="strain-chip" data-strain="yellow">Yellow</div>
                </div>
                
                <!-- Mix Option -->
                <div class="mix-section" id="mix-section" style="display: none;">
                    <h4 style="margin: 0 0 1rem 0;">Mix Two Strains (¬Ω + ¬Ω)</h4>
                    <div class="mix-controls">
                        <select id="mix-strain-1" style="padding: 0.5rem; border-radius: 8px; border: 1px solid #ccc;">
                            <option value="green">Green</option>
                            <option value="red">Red</option>
                            <option value="white">White</option>
                            <option value="yellow">Yellow</option>
                        </select>
                        <select id="mix-strain-2" style="padding: 0.5rem; border-radius: 8px; border: 1px solid #ccc;">
                            <option value="green">Green</option>
                            <option value="red">Red</option>
                            <option value="white">White</option>
                            <option value="yellow">Yellow</option>
                        </select>
                    </div>
                </div>
            </fieldset>

            <!-- Flavor Selection -->
            <fieldset>
                <legend>Add Flavors (Max <span id="pump-limit">4</span> pumps)</legend>
                <div id="pump-counter" style="text-align: center; margin-bottom: 1rem; font-weight: bold; color: var(--color-primary);">
                    0 / <span id="pump-limit-counter">4</span> pumps used
                </div>
                
                <div class="flavor-grid" id="flavor-grid">
                    <div class="flavor-item" data-flavor="mango">
                        <div class="flavor-name">Mango</div>
                        <div class="pump-controls">
                            <button type="button" class="pump-btn minus">‚àí</button>
                            <span class="pump-count">0</span>
                            <button type="button" class="pump-btn plus">+</button>
                        </div>
                    </div>
                    
                    <div class="flavor-item" data-flavor="peach">
                        <div class="flavor-name">Peach</div>
                        <div class="pump-controls">
                            <button type="button" class="pump-btn minus">‚àí</button>
                            <span class="pump-count">0</span>
                            <button type="button" class="pump-btn plus">+</button>
                        </div>
                    </div>
                    
                    <div class="flavor-item" data-flavor="strawberry">
                        <div class="flavor-name">Strawberry</div>
                        <div class="pump-controls">
                            <button type="button" class="pump-btn minus">‚àí</button>
                            <span class="pump-count">0</span>
                            <button type="button" class="pump-btn plus">+</button>
                        </div>
                    </div>
                    
                    <div class="flavor-item" data-flavor="pineapple">
                        <div class="flavor-name">Pineapple</div>
                        <div class="pump-controls">
                            <button type="button" class="pump-btn minus">‚àí</button>
                            <span class="pump-count">0</span>
                            <button type="button" class="pump-btn plus">+</button>
                        </div>
                    </div>
                    
                    <div class="flavor-item" data-flavor="orange">
                        <div class="flavor-name">Orange</div>
                        <div class="pump-controls">
                            <button type="button" class="pump-btn minus">‚àí</button>
                            <span class="pump-count">0</span>
                            <button type="button" class="pump-btn plus">+</button>
                        </div>
                    </div>
                    
                    <div class="flavor-item" data-flavor="vanilla">
                        <div class="flavor-name">Vanilla</div>
                        <div class="pump-controls">
                            <button type="button" class="pump-btn minus">‚àí</button>
                            <span class="pump-count">0</span>
                            <button type="button" class="pump-btn plus">+</button>
                        </div>
                    </div>
                </div>
            </fieldset>

            <!-- Special Instructions -->
            <fieldset>
                <legend>Special Instructions (Optional)</legend>
                <div class="notes-section">
                    <textarea name="notes" placeholder="Any special requests or notes for your drink..."></textarea>
                </div>
            </fieldset>

            <!-- Add to Cart -->
            <button type="submit" class="add-to-cart-btn" id="add-to-cart">
                Add to Cart - <span id="final-price">$9.00</span>
            </button>
        </form>
    </main>

    <script src="/assets/enhanced-drink-builder.js" onerror="console.log('Enhanced drink builder JS not found - using fallback')"></script>
    <script>
        // Drink Builder JavaScript
        const form = document.getElementById('drink-builder-form');
        const priceDisplay = document.getElementById('current-price');
        const finalPriceDisplay = document.getElementById('final-price');
        const pumpCounter = document.getElementById('pump-counter');
        const pumpLimitDisplay = document.getElementById('pump-limit');
        const pumpLimitCounter = document.getElementById('pump-limit-counter');
        
        let currentPrice = 9.00;
        let currentSize = 'medium';
        let currentStrain = 'green';
        let pumpLimit = 4;
        let pumpCount = 0;
        let flavors = {};

        const sizePricing = {
            'medium': { price: 9.00, pumps: 4 },
            'large': { price: 15.00, pumps: 6 },
            'gallon': { price: 100.00, pumps: 12 }
        };

        // Size selection
        document.querySelectorAll('input[name="size"]').forEach(input => {
            input.addEventListener('change', function() {
                // Remove active class from all chips
                document.querySelectorAll('.chip[data-size]').forEach(chip => {
                    chip.classList.remove('active');
                });
                
                // Add active class to selected
                this.parentElement.classList.add('active');
                
                currentSize = this.value;
                const sizeData = sizePricing[currentSize];
                currentPrice = sizeData.price;
                pumpLimit = sizeData.pumps;
                
                updateDisplay();
                resetFlavors();
            });
        });

        // Strain selection
        document.querySelectorAll('.strain-chip').forEach(chip => {
            chip.addEventListener('click', function() {
                document.querySelectorAll('.strain-chip').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                currentStrain = this.dataset.strain;
            });
        });

        // Pump controls
        document.querySelectorAll('.pump-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const flavorItem = this.closest('.flavor-item');
                const flavorName = flavorItem.dataset.flavor;
                const pumpCountElement = flavorItem.querySelector('.pump-count');
                const currentCount = parseInt(pumpCountElement.textContent);
                
                if (this.classList.contains('plus')) {
                    if (pumpCount < pumpLimit) {
                        const newCount = currentCount + 1;
                        pumpCountElement.textContent = newCount;
                        flavors[flavorName] = newCount;
                        pumpCount++;
                        if (newCount > 0) flavorItem.classList.add('active');
                    }
                } else if (this.classList.contains('minus')) {
                    if (currentCount > 0) {
                        const newCount = currentCount - 1;
                        pumpCountElement.textContent = newCount;
                        if (newCount === 0) {
                            delete flavors[flavorName];
                            flavorItem.classList.remove('active');
                        } else {
                            flavors[flavorName] = newCount;
                        }
                        pumpCount--;
                    }
                }
                
                updatePumpCounter();
            });
        });

        function updateDisplay() {
            priceDisplay.textContent = '$' + currentPrice.toFixed(2);
            finalPriceDisplay.textContent = '$' + currentPrice.toFixed(2);
            pumpLimitDisplay.textContent = pumpLimit;
            pumpLimitCounter.textContent = pumpLimit;
        }

        function updatePumpCounter() {
            pumpCounter.innerHTML = `${pumpCount} / ${pumpLimit} pumps used`;
        }

        function resetFlavors() {
            flavors = {};
            pumpCount = 0;
            document.querySelectorAll('.flavor-item').forEach(item => {
                item.classList.remove('active');
                item.querySelector('.pump-count').textContent = '0';
            });
            updatePumpCounter();
        }

        // Form submission
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData();
            formData.append('size', currentSize);
            formData.append('strain', currentStrain);
            formData.append('flavors', JSON.stringify(flavors));
            formData.append('price', currentPrice);
            formData.append('notes', document.querySelector('textarea[name="notes"]').value);
            
            // Simulate add to cart
            alert(`Added to cart!\n\nSize: ${currentSize}\nStrain: ${currentStrain}\nFlavors: ${Object.keys(flavors).map(f => `${f}:${flavors[f]}`).join(', ') || 'None'}\nPrice: $${currentPrice.toFixed(2)}`);
        });

        // Initialize
        updateDisplay();
        updatePumpCounter();
    </script>
</body>
</html>
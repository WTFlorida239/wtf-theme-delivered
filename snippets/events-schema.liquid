{% comment %}
  Events Schema Markup for Competitive Programming
  Generates JSON-LD for WTF events to compete with competitor event visibility
  
  Usage:
  {% render 'events-schema', events: events_array %}
  
  This schema helps WTF compete with venues like Kava Culture by showcasing
  our weekly programming and special events in search results.
{% endcomment %}

{% liquid
  assign events_list = shop.metafields.wtf.events.value | default: blank
  assign page_events = page.metafields.wtf.events.value | default: blank
  
  if page_events != blank
    assign events_list = page_events
  endif
  
  assign business_name = 'WTF | Welcome To Florida'
  assign business_url = shop.secure_url
  assign business_phone = '(239) 955-0314'
  assign business_address = '1520 SE 46th Ln, Unit B, Cape Coral, FL 33904'
%}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "EventSeries",
  "name": "WTF Weekly Events & Programming",
  "description": "Regular events and programming at WTF | Welcome To Florida, Cape Coral's premier kava and kratom lounge",
  "url": "{{ business_url }}/pages/events",
  "organizer": {
    "@type": "Organization",
    "name": "{{ business_name }}",
    "url": "{{ business_url }}",
    "telephone": "{{ business_phone }}",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "1520 SE 46th Ln, Unit B",
      "addressLocality": "Cape Coral",
      "addressRegion": "FL",
      "postalCode": "33904",
      "addressCountry": "US"
    }
  },
  "location": {
    "@type": "Place",
    "name": "{{ business_name }}",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "1520 SE 46th Ln, Unit B",
      "addressLocality": "Cape Coral",
      "addressRegion": "FL",
      "postalCode": "33904",
      "addressCountry": "US"
    },
    "geo": {
      "@type": "GeoCoordinates",
      "latitude": 26.5629,
      "longitude": -81.9495
    },
    "telephone": "{{ business_phone }}"
  },
  "subEvent": [
    {% if events_list != blank %}
      {% for event in events_list %}
        {
          "@type": "Event",
          "name": "{{ event.name | escape }}",
          "description": "{{ event.description | escape }}",
          "startDate": "{{ event.start_date | date: '%Y-%m-%dT%H:%M:%S' }}",
          {% if event.end_date %}
            "endDate": "{{ event.end_date | date: '%Y-%m-%dT%H:%M:%S' }}",
          {% endif %}
          "eventStatus": "https://schema.org/EventScheduled",
          "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
          "location": {
            "@type": "Place",
            "name": "{{ business_name }}",
            "address": {
              "@type": "PostalAddress",
              "streetAddress": "1520 SE 46th Ln, Unit B",
              "addressLocality": "Cape Coral",
              "addressRegion": "FL",
              "postalCode": "33904",
              "addressCountry": "US"
            }
          },
          "organizer": {
            "@type": "Organization",
            "name": "{{ business_name }}",
            "url": "{{ business_url }}"
          },
          {% if event.price %}
            "offers": {
              "@type": "Offer",
              "price": "{{ event.price }}",
              "priceCurrency": "USD",
              "availability": "https://schema.org/InStock"
            },
          {% endif %}
          "isAccessibleForFree": {% if event.price %}false{% else %}true{% endif %}
        }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    {% else %}
      {
        "@type": "Event",
        "name": "Kava Social Hour",
        "description": "Join us every Wednesday for our weekly Kava Social Hour featuring traditional kava preparation demonstrations, community discussions, and special pricing on kava drinks.",
        "startDate": "2025-01-01T18:00:00",
        "endDate": "2025-01-01T21:00:00",
        "eventStatus": "https://schema.org/EventScheduled",
        "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
        "location": {
          "@type": "Place",
          "name": "{{ business_name }}",
          "address": {
            "@type": "PostalAddress",
            "streetAddress": "1520 SE 46th Ln, Unit B",
            "addressLocality": "Cape Coral",
            "addressRegion": "FL",
            "postalCode": "33904",
            "addressCountry": "US"
          }
        },
        "organizer": {
          "@type": "Organization",
          "name": "{{ business_name }}",
          "url": "{{ business_url }}"
        },
        "isAccessibleForFree": true,
        "keywords": "kava, social hour, Cape Coral, community, botanical beverages"
      },
      {
        "@type": "Event",
        "name": "Friday Night Game Night",
        "description": "Weekly game night featuring board games, card games, and video games in a relaxed, sober-friendly environment. Bring friends or make new ones!",
        "startDate": "2025-01-03T20:00:00",
        "endDate": "2025-01-03T23:00:00",
        "eventStatus": "https://schema.org/EventScheduled",
        "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
        "location": {
          "@type": "Place",
          "name": "{{ business_name }}",
          "address": {
            "@type": "PostalAddress",
            "streetAddress": "1520 SE 46th Ln, Unit B",
            "addressLocality": "Cape Coral",
            "addressRegion": "FL",
            "postalCode": "33904",
            "addressCountry": "US"
          }
        },
        "organizer": {
          "@type": "Organization",
          "name": "{{ business_name }}",
          "url": "{{ business_url }}"
        },
        "isAccessibleForFree": true,
        "keywords": "game night, social, Cape Coral, sober nightlife, community"
      }
    {% endif %}
  ],
  "keywords": "kava events, kratom workshops, Cape Coral events, sober nightlife, community programming, Southwest Florida",
  "inLanguage": "en-US",
  "isAccessibleForFree": true
}
</script>
